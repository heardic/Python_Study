# -*- coding: utf-8 -*-
import csv

print("ğŸŒŸ CSV æ¨¡å—ç»ƒä¹ ï¼šè¯»å’Œå†™è¡¨æ ¼æ•°æ® ğŸŒŸ\n")

# ==================== 1. å†™å…¥ CSV æ–‡ä»¶ ====================
print("1. âœï¸ å†™å…¥ CSV æ–‡ä»¶ï¼šåˆ›å»ºä¸€ä¸ªå­¦ç”Ÿæˆç»©è¡¨")

# è¦å†™å…¥çš„æ•°æ®ï¼ˆæ¯ä¸€è¡Œæ˜¯ä¸€ä¸ªå­¦ç”Ÿï¼‰
students = [
    ["å§“å", "å¹´é¾„", "è¯­æ–‡", "æ•°å­¦", "è‹±è¯­"],  # è¡¨å¤´
    ["å°æ˜", 15, 88, 92, 85],
    ["å°çº¢", 16, 90, 87, 94],
    ["å°åˆš", 15, 78, 85, 80],
    ["å°ä¸½", 16, 92, 90, 88]
]

# æ‰“å¼€ä¸€ä¸ªæ–‡ä»¶ï¼Œå‡†å¤‡å†™å…¥
with open('students.csv', 'w', encoding='utf-8', newline='') as f:
    writer = csv.writer(f)
    # ä¸€è¡Œä¸€è¡Œå†™å…¥
    for row in students:
        writer.writerow(row)

print("âœ… å·²åˆ›å»ºæ–‡ä»¶ 'students.csv'ï¼Œå†…å®¹å·²ä¿å­˜ï¼")
print()

# ==================== 2. è¯»å– CSV æ–‡ä»¶ ====================
print("2. ğŸ“– è¯»å– CSV æ–‡ä»¶ï¼šè¯»å–åˆšæ‰ä¿å­˜çš„æ•°æ®")

with open('students.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    for row in reader:
        print(" | ".join(row))  # ç”¨ç«–çº¿åˆ†éš”ï¼Œå¥½çœ‹ä¸€ç‚¹

print()

# ==================== 3. ç”¨å­—å…¸æ–¹å¼å†™å…¥ï¼ˆæ›´ç›´è§‚ï¼‰====================
print("3. ğŸ·ï¸ ç”¨å­—å…¸å†™å…¥ï¼šæ›´æ¸…æ¥šæ¯ä¸€åˆ—æ˜¯ä»€ä¹ˆ")

# æ•°æ®ç”¨å­—å…¸è¡¨ç¤ºï¼Œæ›´æ¸…æ™°
fieldnames = ['å§“å', 'æ°´æœ', 'æ•°é‡', 'ä»·æ ¼']
fruits = [
    {'å§“å': 'å°æ˜', 'æ°´æœ': 'è‹¹æœ', 'æ•°é‡': 3, 'ä»·æ ¼': 5.5},
    {'å§“å': 'å°çº¢', 'æ°´æœ': 'é¦™è•‰', 'æ•°é‡': 6, 'ä»·æ ¼': 3.0},
    {'å§“å': 'å°åˆš', 'æ°´æœ': 'æ©™å­', 'æ•°é‡': 4, 'ä»·æ ¼': 8.0},
]

with open('fruits.csv', 'w', encoding='utf-8', newline='') as f:
    writer = csv.DictWriter(f, fieldnames=fieldnames)
    writer.writeheader()  # å…ˆå†™è¡¨å¤´
    for fruit in fruits:
        writer.writerow(fruit)

print("âœ… å·²åˆ›å»ºæ–‡ä»¶ 'fruits.csv'ï¼Œç”¨å­—å…¸æ–¹å¼å†™å…¥å®Œæˆï¼")
print()

# ==================== 4. ç”¨å­—å…¸æ–¹å¼è¯»å– ====================
print("4. ğŸ” ç”¨å­—å…¸è¯»å–ï¼šæŒ‰åˆ—åè¯»æ•°æ®")

with open('fruits.csv', 'r', encoding='utf-8') as f:
    reader = csv.DictReader(f)
    for row in reader:
        # å¯ä»¥ç›´æ¥ç”¨åˆ—åå–å€¼
        print(f"{row['å§“å']} ä¹°äº† {row['æ•°é‡']} ä¸ª {row['æ°´æœ']}ï¼Œå•ä»· {row['ä»·æ ¼']} å…ƒ")

print()

# ==================== 5. ç®€å•ç»ƒä¹ ï¼šç­›é€‰æ•°æ® ====================
print("5. ğŸ” ç»ƒä¹ ï¼šä» students.csv ä¸­æ‰¾å‡ºæ•°å­¦æˆç»© > 90 çš„å­¦ç”Ÿ")

with open('students.csv', 'r', encoding='utf-8') as f:
    reader = csv.reader(f)
    header = next(reader)  # è¯»è¡¨å¤´
    print("æ•°å­¦æˆç»©ä¼˜ç§€çš„å­¦ç”Ÿï¼š")
    for row in reader:
        name = row[0]
        math_score = int(row[3])  # æ•°å­¦åœ¨ç¬¬4åˆ—ï¼ˆç´¢å¼•3ï¼‰
        if math_score > 90:
            print(f"  âœ… {name} : {math_score} åˆ†")

print()

# ==================== 6. å°è´´å£« ====================
print("ğŸ’¡ å°è´´å£«ï¼š")
print("  - å†™æ–‡ä»¶æ—¶ä¸€å®šè¦åŠ  newline=''ï¼Œå¦åˆ™å¯èƒ½å¤šç©ºè¡Œ")
print("  - è¯»å†™éƒ½æ¨èç”¨ encoding='utf-8'ï¼Œæ”¯æŒä¸­æ–‡")
print("  - csv.reader() é€‚åˆæŒ‰è¡Œè¯»")
print("  - csv.DictReader() é€‚åˆæŒ‰åˆ—åè¯»ï¼Œæ›´æ¸…æ™°")
print("  - csv.writer() å†™åˆ—è¡¨")
print("  - csv.DictWriter() å†™å­—å…¸ï¼Œè®°å¾—å…ˆ writeheader()")

print("\nğŸ‰ å­¦ä¹ å®Œæˆï¼å¿«å»è¯•è¯•ç”¨ CSV ä¿å­˜ä½ çš„æ•°æ®å§ï¼")